import pandas as pd
import json
import mysql.connector

def read_xlsx_file():
    xlsx_file_path = '/Users/firaterman/Downloads/jj/events_database.xlsx'
    
    # Read the XLSX file into a DataFrame
    df = pd.read_excel(xlsx_file_path)
    
    return df

def create_mysql_database():
    # Load the JSON configuration file
    json_config_file_path = '/Users/firaterman/Documents/git_workspace/FERMAN/jandj/config/config_event_database.json'
    with open(json_config_file_path) as f:
        config = json.load(f)
    
    # Connect to MySQL server
    connection = mysql.connector.connect(
        user='root',
        password='password',
        host='localhost',
        database='digital_assets'
    )
    
    # Create a cursor to execute SQL queries
    cursor = connection.cursor()
    
    # Create the database
    create_database_query = f"CREATE DATABASE {config['database']}"
    cursor.execute(create_database_query)


    # Commit the changes and close the connection
    connection.commit()
    cursor.close()
    connection.close()

# Read the XLSX file and create a DataFrame
df = read_xlsx_file()

# Create the MySQL database
create_mysql_database()





